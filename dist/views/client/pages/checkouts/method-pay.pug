extends ../../layouts/layouts.pug

block css
    //- link(rel="stylesheet" href="/client/css/carts/index.css")
    link(rel="stylesheet" href="/client/css/checkouts/index.css")
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css")
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/css/bootstrap-select.min.css")

block script
    script(src="https://cdn.jsdelivr.net/npm/sweetalert2@11")
    script(src="https://cdn.jsdelivr.net/npm/axios@1.7.9/dist/axios.min.js")
    script(src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js")
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js")

    script(src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/js/bootstrap-select.min.js")


    script(type='module' src="/client/js/checkouts/method-pay.js") 

block main
    - if(INFOR_CUSTOMER && INFOR_CUSTOMER.id == order.inforCustomer.customerId)
        div(class="")
            div(class=`container`) 
                div(class="max-w-7xl mx-auto")
                    div(class="flex items-center gap-2 text-sm py-[24px]")
                        span(class="text-gray-600") Trang chủ
                        span(class="text-gray-400") >
                        span Giỏ hàng
        div(class="")
            div(class="container") 
                div(class=`grid grid-cols-12 gap-x-[30px]`)
                    // left
                    div(class="col-span-7")
                        div(class="flex flex-col gap-y-[20px]") 
                            // thông tin khách hàng
                            div(class="flex flex-col gap-y-[15px]") 
                                h2(class="text-[25px]  font-bold") Thông tin khách hàng
                                div(class="grid grid-cols-3 items-center") 
                                    div(class="col-span-1") Khách hàng:
                                    div(class="col-span-2 font-bold") #{order.inforCustomer.fullname}
                                div(class="grid grid-cols-3 items-center") 
                                    div(class="col-span-1") Số điện thoại:
                                    div(class="col-span-2 font-bold") #{order.inforCustomer.phone}
                                div(class="grid grid-cols-3 items-center") 
                                    div(class="col-span-1") Email:
                                    div(class="col-span-2 font-bold") #{order.inforCustomer.email}
                                div(class="grid grid-cols-3 items-center") 
                                    div(class="col-span-1") Địa chỉ:
                                    div(class="col-span-2 font-bold") #{order.inforCustomer.address}, #{order.addressNew.wardName}, #{order.addressNew.districtName}, #{order.addressNew.cityName}
                                div(class="grid grid-cols-3 items-center") 
                                    div(class="col-span-1") Ghi chú:
                                    div(class="col-span-2 font-bold") #{order.inforCustomer.note ? order.inforCustomer.note : 'Không có'}
                            // phương thức thanh toán
                            div(class="")
                                h2(class="text-[25px]  font-bold py-[20px]") Phương thức thanh toán
                                sl-radio-group(value='polime' class=''  method-pay )
                                    sl-radio(value='polime' class="mb-[10px]") Tiền mặt
                                    sl-radio(value='bank') Chuyển khoản ngân hàng
                    // right
                    div(class="col-span-5")
                        // thông tin giỏ hàng
                        div(class="flex flex-col gap-y-[15px]")
                            h2(class="text-[25px] font-bold") Giỏ hàng của bạn
                            div(class=`flex-1 py-[20px] px-[24px] rounded-[20px] border-[1px] border-[#0000001A] flex flex-col gap-y-[24px]`) 
                                each it in order.inforProductItem
                                    div(class="flex items-center justify-between bg-white relative" cart-id =  it.id)
                                        div(class="grid grid-cols-12 gap-x-[10px]")
                                            div(class=`col-span-3`) 
                                                img(src=it.image title = it.product_name class=`w-full h-auto rounded-[10px]`)
                                            div(class=`col-span-9 flex flex-col gap-y-[10px]`)
                                                div(href=`${ROUTERS.CLIENT.PRODUCT.PATH}${ROUTERS.CLIENT.PRODUCT.DETAIL}/${it.slug}`) 
                                                    h3(class="text-[15px]") #{it.product_name}
                                                p(class="text-gray-500 text-sm") Kích thước: #{it.product_size}
                                                p(class="text-gray-500 text-sm") Màu: #{it.product_color}
                                                div(class=`flex gap-x-[5px] items-center text-[12px]`) 
                                                    div(class="flex items-center")
                                                        span #{it.quantity}
                                                    div x
                                                    sl-format-number(class="text-lg" type="currency" currency="VND" value=it.price lang="vi" class=`text-[12px]`)
                                                    div #{'='}
                                                    sl-format-number(class="text-lg" type="currency" currency="VND" value=it.newPrice lang="vi" class=`font-bold`)
                            div(class="flex flex-col gap-y-[10px]")
                                div(class="grid grid-cols-2") 
                                    div(class="") Đơn giá:
                                    sl-format-number(class="text-lg" type="currency" currency="VND" value=order.totalPrice lang="vi" class=`font-bold`)
                                div(class="grid grid-cols-2") 
                                    div(class="") Phí vận chuyển:
                                    sl-format-number(class="text-lg" type="currency" currency="VND" value=order.shipping_fee lang="vi" class=`font-bold`)
                                div(class="grid grid-cols-2") 
                                    div(class="") Thành tiền:
                                    sl-format-number(class="text-lg" type="currency" currency="VND" value=order.totalPrice + order.shipping_fee lang="vi" class=`font-bold text-[red]`)
                sl-button(data-twe-ripple-init variant="success" class="w-full my-[20px]" order-id = order.id price = order.totalPrice + order.shipping_fee link = `${ROUTERS.CLIENT.CHECKOUT.PATH}${ROUTERS.CLIENT.CHECKOUT.CHANGE_STATUS_POLIME_SUCCESS}/${order.id}` redirect = `${ROUTERS.CLIENT.CHECKOUT.PATH}${ROUTERS.CLIENT.CHECKOUT.SUCCESS}/${INFOR_CUSTOMER.username}?id-don-hang=${order.id}`) Thanh toán ngay
        sl-dialog(label="Chuyển khoản ngân hàng" class="" dialog-bank)
            - let BANK_ID = 'vietinbank';
            - let ACCOUNT_NO = '109880050106';
            - let TEMPLATE = 'compact2';
            - let AMOUNT = order.totalPrice + order.shipping_fee;
            - let DESCRIPTION = `ORD${order.id}`;
            - let ACCOUNT_NAME = 'TRAN KIM QUANG';
            sl-button(class="w-full mb-[20px]" variant="primary" check-status-pay = `${ROUTERS.CLIENT.CHECKOUT.PATH}${ROUTERS.CLIENT.CHECKOUT.CHANGE_STATUS_BANK_SUCCESS}/${order.id}` data-twe-ripple-init redirect = `${ROUTERS.CLIENT.CHECKOUT.PATH}${ROUTERS.CLIENT.CHECKOUT.SUCCESS}/${INFOR_CUSTOMER.username}?id-don-hang=${order.id}`) Kiểm tra trạng thái thanh toán ngay
            img(src=`https://img.vietqr.io/image/${BANK_ID}-${ACCOUNT_NO}-${TEMPLATE}.png?amount=${AMOUNT}&addInfo=${DESCRIPTION}&accountName=${ACCOUNT_NAME}` alt='')
    - else if(INFOR_CUSTOMER && INFOR_CUSTOMER.id != order.inforCustomer.customerId)
        div(class='container')
            div(class='text-[2rem] text-center py-[30px]') Bạn không phải chủ nhân của đơn hàng này!
    - else
        div(class='text-[2rem] text-center py-[30px]') Vui lòng đăng nhập để xem nội dung này!